<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Booha Sentence Builder – January Week 1</title>
<meta name="theme-color" content="#0b1530" />
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Noto+Sans+JP:wght@500;700&display=swap" rel="stylesheet" />
<style>
:root{
  --bg:#0b1530; --ink:#fff; --outline:#ffffff26;
  --heart:#ff4fa6; --radius:26px;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{background:#0b1530;color:var(--ink);font-family:system-ui,"Noto Sans JP",sans-serif;}
header{text-align:center;padding:26px 12px 12px}
.h1{font-family:'Cinzel',serif;font-weight:900;font-size:clamp(34px,6.2vw,56px);}
.h2{font-family:'Cinzel',serif;font-weight:900;font-size:clamp(22px,4.5vw,36px);}
.h3{font-family:'Cinzel',serif;font-weight:900;font-size:clamp(16px,3.6vw,22px);}
.h4{font-weight:800;font-size:clamp(14px,3.4vw,20px);color:#cfe1ff;}
.wrap{max-width:1100px;margin:0 auto;padding:8px 16px 80px}
.panel{padding:20px;border:1px solid var(--outline);border-radius:var(--radius);
background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));
box-shadow:0 6px 24px rgba(0,0,0,.4);}

/* Japanese display */
.jpCard{border-radius:var(--radius);border:1px solid var(--outline);height:160px;
display:flex;align-items:center;justify-content:center;margin-bottom:10px;
background:repeating-linear-gradient(to bottom,#ff6ec7 0 28px,#5ee6ff 28px 56px,#ffd166 56px 84px,
#8aff80 84px 112px,#c77dff 112px 140px,#fff680 140px 168px);
background-size:100% 600px;animation:stripeSlide 18s linear infinite;}
@keyframes stripeSlide{from{background-position-y:0}to{background-position-y:-600px}}
.jpText{font-weight:900;font-size:46px;color:#0b1530;text-shadow:0 1px 0 rgba(255,255,255,.6);}
.hira{text-align:center;color:#d8e7ff;font-size:clamp(14px,3.5vw,18px);margin-bottom:20px}

/* drop areas */
.wordbank,.sentence{display:flex;flex-wrap:wrap;gap:12px;padding:12px;margin-bottom:14px;}
.wordbank{justify-content:center;}
.sentence{
  justify-content:flex-start;align-items:center;
  min-height:120px;width:100%;
  border:1px dashed rgba(255,255,255,.25);
  border-radius:14px;padding:16px 12px;position:relative;
}

/* gold play button (UNDER the sentence, LEFT side) */
.playBtn{
  position:absolute;left:12px;bottom:-60px;
  width:54px;height:54px;border:none;border-radius:50%;
  background:linear-gradient(135deg,#c59b10 0%,#ffd95e 40%,#ffe898 60%,#b68006 100%);
  box-shadow:0 0 10px rgba(255,215,64,.6),0 0 16px rgba(255,215,64,.9);
  color:#2a1b00;font-weight:900;font-size:26px;
  opacity:0;pointer-events:none;transition:opacity .3s ease;
}
.playBtn.show{opacity:1;pointer-events:auto;animation:twinkle 2.4s ease-in-out infinite;}
.playBtn::before{content:"▶";display:block;text-align:center;line-height:54px;}
@keyframes twinkle{
  0%,100%{box-shadow:0 0 10px rgba(255,215,64,.6),0 0 16px rgba(255,215,64,.9);}
  50%{box-shadow:0 0 16px rgba(255,235,94,1),0 0 24px rgba(255,235,94,1);}
}

/* chips */
.word{padding:14px 18px;font-weight:900;font-size:clamp(18px,4.2vw,26px);
border:none;border-radius:20px;cursor:grab;user-select:none;
box-shadow:0 0 0 4px var(--color),0 10px 22px rgba(0,0,0,.35);
background:#fff;color:#06101f;text-shadow:0 1px 0 rgba(255,255,255,.65);}
.word:active{transform:scale(.96)}

/* buttons */
.btn{display:block;margin:16px auto 8px;border:none;border-radius:999px;
padding:16px 36px;font-weight:900;font-size:clamp(18px,4vw,22px);
cursor:pointer;}
.btn.green{background:radial-gradient(circle at 30% 30%,#1ee99a,#15c473,#0ea85d);color:#00230f;
box-shadow:0 0 0 5px rgba(34,197,94,.22),0 0 18px rgba(34,197,94,.8);}
.btn.blue{background:radial-gradient(circle at 30% 30%,#66b3ff,#1e6eff);color:#00163a;
box-shadow:0 0 0 5px rgba(102,179,255,.22),0 0 18px rgba(102,179,255,.8);}
.btn.pink{background:radial-gradient(circle at 30% 30%,#ff90e8,#ff53c2,#ff2fa6);color:#30001a;
box-shadow:0 0 0 5px rgba(255,83,194,.25),0 0 18px rgba(255,83,194,.7);}
.btn:disabled{opacity:.4;cursor:not-allowed}

/* FX */
.fx{position:fixed;inset:0;pointer-events:none;z-index:1000}
.heart{position:absolute;color:var(--heart);font-size:clamp(46px,8vw,84px);
animation:heartFly 1.2s ease-out forwards;}
@keyframes heartFly{
  0%{opacity:0;transform:translate(-50%,-10px) scale(.7)}
  20%{opacity:1}
  100%{opacity:0;transform:translate(var(--dx),calc(-200px - var(--up))) scale(1.3)}
}
.smoke{
  position:absolute;border-radius:50%;
  width:var(--w,78px);height:var(--h,78px);
  background:radial-gradient(circle at 40% 40%,#fff,rgba(255,255,255,.6) 55%,rgba(255,255,255,0) 72%);
  filter:blur(0.5px);
  animation:smokeRise 1.2s ease-out forwards;
}
@keyframes smokeRise{
  0%{opacity:0;transform:translate(-50%,0) scale(.7)}
  20%{opacity:.9}
  100%{opacity:0;transform:translate(calc(-50% + var(--sx)),calc(-180px - var(--up))) scale(1.1)}
}

/* results */
.end{position:fixed;inset:0;display:none;flex-direction:column;align-items:center;justify-content:center;text-align:center;}
.end .msg{font-weight:900;font-size:clamp(26px,6vw,42px);}
.end .score{font-weight:900;font-size:clamp(22px,5vw,30px);margin:10px auto 20px;}
footer{text-align:center;color:#c9d4ec;font-family:'Cinzel',serif;font-weight:700;padding:40px 10px}
</style>
</head>
<body>
<header>
  <div class="h1">THE BOO-RICULUM</div>
  <div class="h2">GAMES & QUIZZES</div>
  <div class="h3">January Week 1 – Sentences</div>
  <div class="h4">１月第１週 – 文の練習</div>
</header>

<div class="wrap">
<div class="panel" id="panel">
  <div class="jpCard"><div id="jp" class="jpText"></div></div>
  <div id="hira" class="hira"></div>
  <div id="bank" class="wordbank"></div>

  <div style="position:relative;">
    <div id="sentence" class="sentence">
      <button id="playBtn" class="playBtn" title="Play"></button>
    </div>
  </div>

  <div id="okWrap" style="text-align:center;display:none">
    <div>正しい順番に並べてから OK をクリック</div>
    <button id="okBtn" class="btn pink" disabled>OK</button>
  </div>

  <div id="nextWrap" style="text-align:center;display:none">
    <button id="nextBtn" class="btn blue">Next</button>
  </div>

  <button id="checkBtn" class="btn green" disabled>Check</button>
  <div id="progress">1 / 15</div>
</div>
</div>

<div id="end" class="end">
  <div class="msg" id="endMsg"></div>
  <div class="score" id="scoreText"></div>
  <button class="btn blue" onclick="window.location.href='index.html'">Back to Main Menu</button>
  <footer style="opacity:.8">Bryan’s English School</footer>
</div>

<div id="fx" class="fx"></div>
<footer>Bryan’s English School</footer>

<script>
const DATA=[
{en:"I will study every day.",jp:"毎日勉強します。",hira:"まいにち べんきょう します"},
{en:"I will clean my desk today.",jp:"今日は机を片づけます。",hira:"きょう は つくえ を かたづけ ます"},
{en:"I will speak more English.",jp:"もっと英語を話します。",hira:"もっと えいご を はなし ます"},
{en:"I will make a new friend.",jp:"新しい友だちを作ります。",hira:"あたらしい ともだち を つくり ます"},
{en:"I will not be late anymore.",jp:"もう遅刻しません。",hira:"もう ちこく しません"},
{en:"I will listen carefully in class.",jp:"授業でしっかり聞きます。",hira:"じゅぎょう で しっかり きき ます"},
{en:"I will read more books.",jp:"もっと本を読みます。",hira:"もっと ほん を よみ ます"},
{en:"I will write in my diary every week.",jp:"毎週日記を書きます。",hira:"まいしゅう にっき を かき ます"},
{en:"I will enjoy learning.",jp:"学ぶことを楽しみます。",hira:"まなぶ こと を たのしみ ます"},
{en:"I will try new things.",jp:"新しいことに挑戦します。",hira:"あたらしい こと に ちょうせん します"},
{en:"I will help my friends.",jp:"友だちを助けます。",hira:"ともだち を たすけ ます"},
{en:"I will eat more vegetables.",jp:"もっと野菜を食べます。",hira:"もっと やさい を たべ ます"},
{en:"I will sleep early.",jp:"早く寝ます。",hira:"はやく ね ます"},
{en:"I will do my homework first.",jp:"まず宿題をします。",hira:"まず しゅくだい を し ます"},
{en:"I will be kind to everyone.",jp:"みんなにやさしくします。",hira:"みんな に やさしく し ます"}
];

let i=0,score=0,wrongMode=false;
const jp=qs('#jp'),hira=qs('#hira'),bank=qs('#bank'),sent=qs('#sentence');
const check=qs('#checkBtn'),okWrap=qs('#okWrap'),okBtn=qs('#okBtn'),nextWrap=qs('#nextWrap'),nextBtn=qs('#nextBtn');
const playBtn=qs('#playBtn'),progress=qs('#progress'),fx=qs('#fx'),panel=qs('#panel'),end=qs('#end'),scoreText=qs('#scoreText'),endMsg=qs('#endMsg');
function qs(s){return document.querySelector(s)}

function sfx(name){
  const a=new Audio(`assets/audio/${name}.mp3`);
  a.volume=1; a.play().catch(()=>{});
}
function filename(en){return "audio/"+en.toLowerCase().replace(/[^a-z]/g,'')+".mp3";}
function playSage(en,onEnd){
  const a=new Audio(filename(en));
  let done=false;
  a.onended=()=>{ if(done)return; done=true; if(onEnd) onEnd(); };
  a.onerror=()=>{ if(done)return; done=true; if(onEnd) onEnd(); };
  a.play().catch(()=>{ if(!done){done=true; if(onEnd) onEnd();} });
  setTimeout(()=>{ if(!done){done=true; if(onEnd) onEnd();} },7000);
}

function mount(){
  bank.innerHTML='';sent.innerHTML='';sent.appendChild(playBtn);
  playBtn.classList.remove('show');wrongMode=false;
  okWrap.style.display='none';nextWrap.style.display='none';
  okBtn.disabled=true;check.disabled=true;check.style.display='block';
  check.onclick=null;

  const item=DATA[i];jp.textContent=item.jp;hira.textContent=item.hira;
  const words=item.en.trim().split(/\s+/);shuffle(words).forEach((w,idx)=>{
    const b=document.createElement('button');b.textContent=w;b.className='word';
    b.style.setProperty('--color',chipColor(idx));
    b.draggable=true;
    b.addEventListener('dragstart',()=>b.classList.add('drag'));
    b.addEventListener('dragend',()=>b.classList.remove('drag'));
    bank.appendChild(b);
  });
  updateProgress();
  check.onclick=()=>{check.disabled=true;checkLogic();};
}

['bank','sentence'].forEach(id=>{
  const area=document.getElementById(id);
  area.addEventListener('dragover',e=>e.preventDefault());
  area.addEventListener('drop',e=>{
    e.preventDefault();
    const drag=document.querySelector('.drag');if(!drag)return;
    area.appendChild(drag);
    check.disabled=bank.children.length!==0;
    if(wrongMode) okBtn.disabled=currentBuilt()!==currentCorrect();
  });
});

function currentBuilt(){return [...sent.querySelectorAll('.word')].map(e=>e.textContent).join(' ').trim();}
function currentCorrect(){return DATA[i].en.trim();}

function checkLogic(){
  const correct=currentCorrect(),built=currentBuilt();
  if(built===correct){
    if(!wrongMode){
      score++;sfx('sugoi');heartsBurst(sent);
      setTimeout(()=>{playSage(correct,()=>{nextWrap.style.display='block';});},700);
    }else{okBtn.textContent="Next";okBtn.disabled=false;}
  }else{
    wrongMode=true;sfx('yada');smokeBurst(sent);
    playBtn.classList.add('show');
    check.style.display='none';okWrap.style.display='block';okBtn.disabled=true;
  }
}

okBtn.onclick=()=>{
  if(wrongMode && okBtn.textContent==="Next"){next();}
  else if(wrongMode && currentBuilt()===currentCorrect()){okBtn.textContent="Next";okBtn.disabled=false;}
};
nextBtn.onclick=()=>next();
playBtn.onclick=()=>{if(wrongMode)playSage(currentCorrect());};

function next(){
  i++;if(i>=DATA.length)return finish();
  mount();
}
function finish(){
  panel.style.display='none';end.style.display='flex';
  scoreText.textContent=`スコア：${score}/${DATA.length}`;
  endMsg.textContent=score<DATA.length?"Good try!":"Perfect!";
}

/* ---- FX ---- */
function heartsBurst(el){
  const r=el.getBoundingClientRect(),cx=r.left+r.width/2,cy=r.top+r.height/2;
  const radius=42;
  for(let n=0;n<5;n++){
    const angle=(-60+n*30)*Math.PI/180;
    const dx=Math.cos(angle)*radius+(Math.random()*6-3);
    const up=40+Math.random()*30;
    const h=document.createElement('div');h.className='heart';h.textContent='❤';
    h.style.left=cx+'px';h.style.top=cy+'px';
    h.style.setProperty('--dx',dx+'px');
    h.style.setProperty('--up',up+'px');
    fx.appendChild(h);
    setTimeout(()=>h.remove(),1200);
  }
}
function smokeBurst(el){
  const r=el.getBoundingClientRect(),cx=r.left+r.width/2,cy=r.top+r.height/2;
  for(let k=0;k<3;k++){
    const s=document.createElement('div');s.className='smoke';
    const w=68+Math.random()*14;
    s.style.setProperty('--w',w+'px');
    s.style.setProperty('--h',w+'px');
    s.style.left=cx+'px';s.style.top=cy+'px';
    s.style.setProperty('--sx',(Math.random()<.5?-1:1)*(10+Math.random()*18)+'px');
    s.style.setProperty('--up',(20+Math.random()*25)+'px');
    fx.appendChild(s);
    setTimeout(()=>s.remove(),1200);
  }
}
function chipColor(n){
  const c=["#ff6ec7","#5ee6ff","#ffd166","#8aff80","#c77dff","#fff680","#ff9a8b","#9bffb7","#7cc6ff","#f7a6ff"];
  return c[n%c.length];
}
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}
function updateProgress(){progress.textContent=`${i+1} / ${DATA.length}`;}
mount();
</script>
</body>
</html>
