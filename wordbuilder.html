<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Booha Word Builder – January Week 1</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Noto+Sans+JP:wght@500;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b1530; --ink:#fff; --outline:#ffffff26; --radius:26px;
  --gold1:#fdd86d; --gold2:#ffb347; --goldGlow:0 0 20px #facc15,0 0 40px #fde68a;
  --green:#22c55e; --red:#ef4444; --purple:#7c3aed;
}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--ink);font-family:system-ui,'Noto Sans JP',sans-serif;min-height:100vh;display:flex;flex-direction:column;overflow-x:hidden}

/* ===== HEADER ===== */
header{padding:18px 16px 8px;text-align:center;z-index:5;position:relative}
header h1, header h2, header h3{font-family:'Cinzel',serif;letter-spacing:.6px}
header h1{font-size:clamp(1.6rem,4.8vw,2.2rem);opacity:.95}
header h2{font-size:clamp(2.0rem,6.2vw,3.1rem);text-shadow:0 0 10px rgba(255,255,255,.12);margin-top:4px}
header h3{font-size:clamp(1rem,3.5vw,1.2rem);opacity:.9;margin-top:6px}

main{flex:1;display:flex;flex-direction:column;align-items:center;gap:16px;padding:8px 12px 24px;position:relative;overflow:hidden;z-index:1}

/* ===== PLAY BUTTON ===== */
.playWrap{display:flex;justify-content:center;align-items:center;margin-top:0;position:relative;z-index:50}
.playBtn{appearance:none;border:none;cursor:pointer;width:240px;height:240px;border-radius:999px;display:grid;place-items:center;font-size:6rem;font-weight:900;color:#0b1530;background:conic-gradient(from 0deg,#ff4fa6,#ffa733,#ffe066,#fdd86d,#fff3b0,#ffd54a,#ff4fa6);box-shadow:0 0 70px #ffd54a99,0 0 140px #ffe59999;filter:hue-rotate(0deg);animation:huerotate 4s linear infinite,pulse 2.2s ease-in-out infinite;position:relative;overflow:hidden}
.playBtn span{transform:translateX(4px)}
@keyframes huerotate{to{filter:hue-rotate(360deg)}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}
.playBtn:active{transform:scale(.98)}

/* ===== FIZZY GOLD EFFECT ===== */
.playBtn.fizzy::before, .playBtn.fizzy::after{
  content:"";position:absolute;inset:0;border-radius:999px;pointer-events:none;
}
.playBtn.fizzy::before{
  background:
  radial-gradient(circle at 20% 80%,rgba(255,215,0,.6),transparent 60%),
  radial-gradient(circle at 80% 30%,rgba(255,255,200,.6),transparent 60%),
  radial-gradient(circle at 50% 50%,rgba(255,255,150,.3),transparent 60%);
  animation:fizzmove .5s infinite linear;
}
.playBtn.fizzy::after{
  box-shadow:0 0 40px 10px #fff8,0 0 90px 20px #ffd54a80;
  animation:fizzglow .3s ease-in-out infinite alternate;
}
@keyframes fizzmove{
  0%{transform:translate(0,0) rotate(0deg)}
  50%{transform:translate(-3px,-3px) rotate(180deg)}
  100%{transform:translate(0,0) rotate(360deg)}
}
@keyframes fizzglow{
  0%{opacity:.3;filter:blur(3px)}
  100%{opacity:.9;filter:blur(8px)}
}

/* ===== CARD ===== */
.card{width:min(980px,96vw);border:1px solid var(--outline);border-radius:var(--radius);padding:18px 16px;background:rgba(255,255,255,0.04);box-shadow:0 10px 30px rgba(0,0,0,.25);}

/* ===== DROP ZONE ===== */
.dropZone{margin:20px auto 14px;display:flex;gap:18px;justify-content:center;flex-wrap:wrap;min-height:112px}
.slot{width:96px;height:112px;border:2px dashed #ffffff2e;border-radius:18px;display:flex;align-items:center;justify-content:center;font-size:56px;font-weight:900;background:#12142a80;transition:background .25s,border-color .25s,box-shadow .25s;flex-shrink:0;white-space:nowrap}
.slot.filled{background:#14183a;border:2px solid #ffffff80;box-shadow:0 0 12px #facc15}
.slot.gold{background:#1b1630;border-color:#ffd54a;box-shadow:0 0 18px #ffd54a,0 0 32px #ffe59966}

/* ===== LETTER BANK ===== */
.bank{display:flex;gap:18px;justify-content:center;flex-wrap:wrap;padding:16px 12px;border-radius:16px;background:rgba(255,255,255,0.03);border:1px dashed #ffffff22;min-height:110px}
.tile{user-select:none;-webkit-user-drag:none;width:96px;height:96px;border-radius:18px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:54px;background:#1b2046;border:1px solid #8690ff33;box-shadow:0 8px 14px rgba(0,0,0,.28);cursor:grab;transition:transform .12s ease,box-shadow .12s ease;white-space:nowrap;overflow:hidden;text-overflow:clip}
.tile:active{cursor:grabbing;transform:scale(.97)}
.tile.lit{box-shadow:0 0 16px #a78bfa99,0 0 30px #a78bfa55}

/* ===== HEART & FART EFFECTS ===== */
@keyframes floatHeart{
  0%{transform:translateY(0) scale(1);opacity:1}
  100%{transform:translateY(-140px) scale(1.6);opacity:0}
}
@keyframes fartCloud{
  0%{transform:scale(0.6);opacity:0}
  40%{transform:scale(1.2);opacity:1}
  100%{transform:translateY(-60px) scale(1.6);opacity:0}
}
.heart,.fart{position:absolute;font-size:36px;pointer-events:none}
.heart{color:#ff4fa6;animation:floatHeart 1.3s ease-out forwards}
.fart{color:#ccc;animation:fartCloud 1.2s ease-out forwards}

/* ===== CONTROLS ===== */
.controls{display:flex;gap:12px;justify-content:center;align-items:center;margin-top:10px}
.btn{appearance:none;border:none;cursor:pointer;padding:12px 20px;border-radius:14px;font-weight:800;font-size:16px;color:#0b1530;background:#e5e7eb}
.btn.primary{background:linear-gradient(135deg,#a78bfa,#7c3aed);color:#fff;box-shadow:0 0 20px #7c3aed66}

footer{text-align:center;font-size:clamp(.9rem,2.5vw,1.05rem);opacity:.9;padding:14px 0 16px;border-top:1px solid var(--outline);font-family:'Cinzel',serif}
.dropZone,.bank,.tile,.slot{touch-action:none}
</style>
</head>
<body>
<header>
  <h1>THE BOO-RICULUM</h1>
  <h2>WORD BUILDER</h2>
  <h3>January Week 1 – １月第１週</h3>
</header>

<main>
  <div class="playWrap">
    <button class="playBtn" id="playBtn" aria-label="Play word"><span>▶</span></button>
  </div>
  <div class="card">
    <div class="dropZone" id="dropZone"></div>
    <div class="bank" id="bank"></div>
    <div class="controls">
      <button class="btn primary" id="checkBtn" disabled>CHECK</button>
    </div>
  </div>
</main>

<footer>
  Bryan's English School
</footer>

<script>
const MASTER=["goal","plan","future","dream","challenge","try","change","habit","exercise","study","learn","practice","success","focus","motivation"].map(w=>w.toLowerCase());
let index=0;
const drop=document.getElementById('dropZone');
const bank=document.getElementById('bank');
const play=document.getElementById('playBtn');
const check=document.getElementById('checkBtn');

const sfx={ding:new Audio('assets/audio/ding.mp3'),fart:new Audio('assets/audio/fart.mp3')};
Object.values(sfx).forEach(a=>a.preload='auto');
const sage=new Map();
MASTER.forEach(w=>{const a=new Audio(`audio/${w}.mp3`);a.preload='auto';sage.set(w,a);});

function speak(){
  const word=MASTER[index];
  const a=sage.get(word);
  if(!a) return;
  play.classList.add('fizzy');
  a.currentTime=0;
  a.play().catch(()=>{});
  a.onended=()=>play.classList.remove('fizzy');
}

/* === Effects === */
function spawnHeart(x,y){
  const h=document.createElement('div');
  h.className='heart';
  h.textContent='❤️';
  h.style.left=x+'px';h.style.top=y+'px';
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),1300);
}
function spawnFart(x,y){
  const f=document.createElement('div');
  f.className='fart';
  f.textContent='💨';
  f.style.left=x+'px';f.style.top=y+'px';
  document.body.appendChild(f);
  setTimeout(()=>f.remove(),1200);
}

/* === Glow === */
const glowColors=['#a78bfa','#22c55e','#3b82f6','#f59e0b','#ef4444','#f472b6'];
let glowTimer=null, glowIdx=0;
function startGlowSequence(){stopGlowSequence();glowIdx=0;glowTimer=setInterval(()=>{
  const slots=[...drop.children];if(!slots.length)return;
  slots.forEach(s=>{if(!s.classList.contains('filled'))s.style.boxShadow='none';});
  let count=0;let i=glowIdx;
  while(count<slots.length&&slots[i%slots.length].classList.contains('filled')){i++;count++;}
  const target=slots[i%slots.length];
  const color=glowColors[i%glowColors.length];
  if(target&&!target.classList.contains('filled')){
    target.style.boxShadow=`0 0 20px ${color},0 0 40px ${color}66`;
    glowIdx=(i+1)%slots.length;
  }
},450);}
function stopGlowSequence(){if(glowTimer){clearInterval(glowTimer);glowTimer=null;}}
function setGoldSteady(){[...drop.children].forEach(s=>{s.classList.add('gold');s.style.boxShadow='0 0 18px #ffd54a,0 0 32px #ffe59966';});}

/* === Drag & Drop === */
function attachSlotDnD(slot){
  slot.addEventListener('dragover',e=>e.preventDefault());
  slot.addEventListener('drop',e=>{
    e.preventDefault();
    const id=e.dataTransfer.getData('text/plain');
    const t=document.getElementById(id);
    if(t)placeTileInSlot(t,slot);
  });
}
function attachTileDnD(tile){
  tile.draggable=true;
  tile.addEventListener('dragstart',e=>{
    e.dataTransfer.setData('text/plain',tile.id);
    requestAnimationFrame(()=>tile.style.opacity='.7');
  });
  tile.addEventListener('dragend',()=>{tile.style.opacity='1';enableCheck();});
  tile.addEventListener('pointerdown',e=>{
    tile.setPointerCapture(e.pointerId);
    const rect=tile.getBoundingClientRect();
    const ox=e.clientX-rect.left,oy=e.clientY-rect.top;
    const move=ev=>{
      tile.style.position='fixed';
      tile.style.left=(ev.clientX-ox)+'px';
      tile.style.top=(ev.clientY-oy)+'px';
      tile.style.zIndex='1000';
    };
    const up=ev=>{
      tile.releasePointerCapture(e.pointerId);
      document.removeEventListener('pointermove',move);
      document.removeEventListener('pointerup',up);
      const vis=tile.style.visibility;
      tile.style.visibility='hidden';
      const el=document.elementFromPoint(ev.clientX,ev.clientY);
      tile.style.visibility=vis;
      tile.style.position='';tile.style.left='';tile.style.top='';tile.style.zIndex='';
      const slot=el?(el.classList?.contains('slot')?el:el.closest?.('.slot')):null;
      if(slot)placeTileInSlot(tile,slot);else{bank.appendChild(tile);enableCheck();}
    };
    document.addEventListener('pointermove',move);
    document.addEventListener('pointerup',up);
  });
}

function placeTileInSlot(tile,slot){
  if(slot.firstChild)bank.appendChild(slot.firstChild);
  slot.appendChild(tile);
  slot.classList.add('filled');
  tile.classList.add('lit');
  tile.style.fontSize='clamp(28px,6vw,54px)';
  enableCheck();
  if(allFilled()){stopGlowSequence();setGoldSteady();}
}
function enableCheck(){check.disabled=!allFilled();}
function allFilled(){return[...drop.children].every(s=>s.firstChild);}
function currentAnswer(){return[...drop.children].map(s=>s.firstChild?s.firstChild.textContent:'').join('');}

/* === Build === */
function buildSlots(word){
  drop.innerHTML='';
  for(let i=0;i<word.length;i++){const s=document.createElement('div');s.className='slot';attachSlotDnD(s);drop.appendChild(s);}
}
function buildBank(word){
  bank.innerHTML='';
  const chars=[...word];let scrambled=[...chars];
  if(chars.length>1){do{scrambled.sort(()=>Math.random()-.5);}while(scrambled.join('')===word);}
  scrambled.forEach((ch,i)=>{
    const t=document.createElement('div');
    t.className='tile';t.id=`tile-${Date.now()}-${i}`;t.textContent=ch;
    attachTileDnD(t);bank.appendChild(t);
  });
}

/* === Game Flow === */
function loadCard(){
  const w=MASTER[index];
  buildSlots(w);buildBank(w);
  check.disabled=true;startGlowSequence();
}
play.addEventListener('click',()=>speak());

check.addEventListener('click',()=>{
  const ans=currentAnswer(),correct=MASTER[index];
  if(ans===correct){
    try{sfx.ding.currentTime=0;sfx.ding.play();}catch{}
    const letters=[...drop.querySelectorAll('.tile')];
    letters.forEach(t=>{
      const r=t.getBoundingClientRect();
      spawnHeart(r.left+r.width/2,r.top);
    });
    setTimeout(()=>{
      index=(index+1)%MASTER.length;
      loadCard();
    },1200);
  }else{
    [...drop.children].forEach(s=>{
      if(s.firstChild){
        const t=s.firstChild;
        const r=t.getBoundingClientRect();
        t.style.background='#3b0f0f';
        spawnFart(r.left+r.width/2,r.top);
        setTimeout(()=>t.style.background='#1b2046',800);
        bank.appendChild(t);
      }
      s.classList.remove('filled');
      s.style.boxShadow='';
    });
    try{sfx.fart.currentTime=0;sfx.fart.play();}catch{}
    startGlowSequence();enableCheck();
  }
});

/* === Init === */
loadCard();
</script>
</body>
</html>
